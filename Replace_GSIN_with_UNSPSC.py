import csv
import os
import pandas as pd 

d = {'GSIN': 'UNSPSC', '5159': '72154000', '5169': '72153701', '5162': '72151100', '5161': '72151207', '5163': '72101519', '5121': '72111000', '5122': '72111100', '5123': '72121000', '5124': '72153300', '5129': '72154600', '5131': '72141605', '5151': '72141130', '5138': '72141206', '5139': '72141600', '5113': '72153900', '5114': '72141511', '5112': '72141510', '5173': '72151308', '5175': '72152500', '5164': '72153609', '5156': '72151900', '5172': '72152000', '5165': '72153200', '5174': '72153607', '5176': '72153611', '5171': '72153608', '5153': '72152607', '5154': '72152700', '5152': '72152800', '5155': '72152900', '5125': '72153100', '5116': '72153400', '5179': '72153500', '5177': '72153612', 'N8800': '10131700', 'N8710': '10122100', 'N3770': '10141600', 'N8730': '10500000', 'N9410': '11122000', 'N8720': '10171800', 'N6840': '10191700', 'N9600': '11100000', 'N9610': '11101600', 'N9620': '31381500', 'N9640': '31321700', 'N9660': '54121802', 'N5510': '30260000', 'N5530': '11121800', 'N9420': '11131500', 'N9430': '11131600', 'N9450': '11141700', 'N8310': '11151700', 'N8300': '11160000', 'N8305': '11162200', 'N8320': '11162300', 'N8330': '11162400', 'N9680': '11191800', 'N6800': '12162000', 'N1145': '12131800', 'N9110': '15101615', 'N6830': '12142200', 'N6850': '12361500', 'N6820': '31221600', 'N9300': '13000000', 'N9320': '13102000', 'N9390': '31271600', 'N9310': '14122200', 'N7530': '14111600', 'N8115': '24121800', 'N9140': '15101802', 'N9130': '15111700', 'N9150': '15121900', 'N9100': '15131600', 'N4470': '41111500', 'N3820': '20121400', 'N3835': '23111600', 'N3700': '21102300', 'N3710': '21102400', 'N3720': '21102500', 'N3730': '21102600', 'N2060': '21111600', 'N3800': '22101500', 'N3805': '22101600', 'N3895': '22102000', 'N3600': '23151600', 'N3200': '23100000', 'N3625': '23291900', 'N3695': '23271800', 'N3645': '23141700', 'N3465': '23150000', 'N3540': '23151500', 'N3611': '23151700', 'N3615': '23151800', 'N3620': '23151900', 'N3635': '23152000', 'N3650': '23152100', 'N3693': '23152200', 'N5325': '31163200', 'N6650': '43223200', 'N3680': '23161700', 'N3605': '23221200', 'N3655': '23200000', 'N3670': '32101600', 'N3220': '23232100', 'N3210': '23232200', 'N3400': '23251600', 'N3411': '23300000', 'N3413': '23290000', 'N3414': '23242100', 'N3415': '23242200', 'N3417': '23291500', 'N3455': '23291700', 'N3456': '23242600', 'N3416': '23242700', 'N3422': '23251700', 'N3441': '23251800', 'N3446': '31310000', 'N3431': '23270000', 'N3439': '23271700', 'N3685': '23281900', 'N3447': '25000000', 'N3900': '24101662', 'N3990': '24101900', 'N3960': '24101601', 'N3950': '24101650', 'N3940': '24101641', 'N3810': '24101657', 'N3910': '24102000', 'N3930': '24102100', 'N4250': '24102200', 'N7125': '56121903', 'N8100': '24102400', 'N8105': '24111515', 'N8110': '24120000', 'N8145': '24122000', 'N4420': '40101848', 'N8125': '24112500', 'N8135': '24141700', 'N4110': '24131900', 'N4130': '24131513', 'N2300': '25101941', 'N2310': '25101700', 'N2320': '25101900', 'N2340': '25161500', 'N2420': '25101901', 'N2330': '25101939', 'N3825': '25101919', 'N2410': '25101923', 'N2350': '25102100', 'N1905': '25111726', 'N1910': '25111600', 'N1920': '25111502', 'N1915': '25111505', 'N1955': '25111504', 'N1925': '25111700', 'N1930': '25111507', 'N1940': '25111809', 'N2050': '25111520', 'N2090': '25111900', 'N2200': '25120000', 'N2210': '25121500', 'N2220': '25121600', 'N2240': '25121700', 'N1500': '25131802', 'N1510': '25131709', 'N1520': '25131906', 'N1540': '25132005', 'N1550': '25132105', 'N1810': '25151500', 'N1830': '25151709', 'N2500': '25171900', 'N2510': '25181700', 'N6220': '25172400', 'N2530': '26110000', 'N4520': '40102000', 'N2540': '25173300', 'N2590': '25174400', 'N2610': '25174600', 'N2895': '26101513', 'N2910': '26101200', 'N2920': '25174900', 'N2930': '25175000', 'N2940': '25175100', 'N4900': '27000000', 'N4910': '27151500', 'N4920': '25191700', 'N4927': '25191800', 'N1560': '25201500', 'N1620': '25202207', 'N1680': '25202700', 'N1660': '25202702', 'N1670': '25201904', 'N1650': '25202505', 'N6100': '39131700', 'N2900': '26101100', 'N6105': '26101500', 'N2805': '26101515', 'N2815': '26101504', 'N2820': '26101505', 'N2840': '26101514', 'N6116': '26101900', 'N3020': '31171700', 'N6115': '26111800', 'N3030': '26111700', 'N6135': '26111900', 'N6150': '39122300', 'N6145': '26121600', 'N4400': '26131800', 'N4540': '47101531', 'N3230': '27110000', 'N3750': '27111500', 'N4930': '27111600', 'N5110': '27112000', 'N5120': '27112400', 'N5130': '27112751', 'N5180': '27112700', 'N5210': '41111700', 'N5220': '27112900', 'N5280': '27113000', 'N7920': '47131900', 'N8000': '27113300', 'N3442': '27131700', 'N9520': '30104000', 'N9510': '30263800', 'N9515': '30266700', 'N5620': '30151516', 'N5680': '31163401', 'N5610': '30122004', 'N5970': '30141700', 'N5670': '30251500', 'N4510': '40141770', 'N5411': '30190000', 'N5440': '30191805', 'N5600': '31282400', 'N3460': '31291400', 'N4010': '31152000', 'N9505': '31152200', 'N5300': '31171800', 'N5305': '31162000', 'N5306': '31162100', 'N5307': '31162200', 'N5310': '31162400', 'N5315': '31162600', 'N5320': '31162700', 'N5335': '31163300', 'N5360': '31163400', 'N3120': '31171600', 'N5365': '31171900', 'N5330': '31401900', 'N5345': '31191600', 'N5350': '31201500', 'N8030': '31201600', 'N8040': '31201700', 'N8010': '31211900', 'N6110': '39121900', 'N5630': '31311700', 'N9540': '31351700', 'N9535': '31361700', 'N9350': '31371400', 'N3408': '31391700', 'N3470': '31411900', 'N5915': '40161800', 'N5961': '32111700', 'N5999': '43201600', 'N5910': '32121500', 'N5905': '32121600', 'N5975': '39121400', 'N5960': '32141100', 'N6240': '39101800', 'N6210': '39112000', 'N6250': '39101900', 'N6230': '39112100', 'N6260': '39112200', 'N6760': '45141612', 'N5935': '39121000', 'N5945': '39121100', 'N5930': '39122200', 'N4140': '40101700', 'N4120': '40100000', 'N4410': '40101800', 'N6685': '41116200', 'N4800': '40141600', 'N6680': '41115800', 'N4300': '40150000', 'N4310': '40151600', 'N4320': '40151800', 'N4330': '40160000', 'N4610': '47101600', 'N4700': '40170000', 'N4710': '40183206', 'N4730': '40183200', 'N6640': '41202103', 'N3000': '41110000', 'N5200': '41111600', 'N6515': '42322800', 'N6605': '41111900', 'N6625': '41112300', 'N6630': '41142100', 'N6635': '41112900', 'N6655': '41114800', 'N6660': '41115100', 'N6670': '41115200', 'N6675': '41115400', 'N6695': '41116500', 'N5840': '46171616', 'N6500': '42180000', 'N6532': '42132200', 'N6530': '42262100', 'N6520': '42153000', 'N6540': '42183500', 'N6525': '42204300', 'N6910': '60106000', 'N5895': '52161611', 'N5805': '43222903', 'N5963': '43201560', 'N5998': '43202222', 'N7035': '43223300', 'N7025': '43212200', 'N5815': '43223001', 'N7021': '43212000', 'N5810': '43222504', 'N5820': '45111902', 'N5830': '43223212', 'N6099': '43223340', 'N7030': '43233701', 'N7400': '44000000', 'N3610': '45101905', 'N7420': '44101810', 'N7520': '54110000', 'N7430': '45102005', 'N7460': '44103207', 'N7490': '44103601', 'N7510': '44122122', 'N5835': '45111504', 'N6730': '45111620', 'N7450': '45112000', 'N5996': '52161547', 'N6700': '45130000', 'N6720': '45121523', 'N6780': '45121810', 'N6770': '45131700', 'N9999': '46000000', 'N1000': '46111700', 'N1005': '46101506', 'N1305': '46101601', 'N1398': '46101703', 'N1095': '46111801', 'N1330': '46111800', 'N1325': '46111506', 'N1010': '46111602', 'N1336': '46121605', 'N1055': '46141502', 'N1040': '46151901', 'N1376': '46151802', 'N2355': '46151509', 'N8465': '46151609', 'N4220': '46161700', 'N4240': '46182300', 'N6350': '46171700', 'N4230': '46182200', 'N8415': '53103100', 'N4210': '46191622', 'N1075': '46221500', 'N7900': '52152300', 'N4600': '47100000', 'N3510': '47111511', 'N7910': '47121900', 'N7930': '47132100', 'N4235': '47141600', 'N7320': '52141800', 'N7200': '52121500', 'N3550': '48111400', 'N3520': '48111109', 'N9930': '48131500', 'N7800': '49131600', 'N9900': '49101710', 'N9915': '49101700', 'N7810': '49241801', 'N7830': '49201600', 'N8940': '50500000', 'N8905': '50122500', 'N8910': '50131800', 'N8920': '50221300', 'N8970': '50193400', 'N8955': '50200000', 'N8960': '50203100', 'N8965': '50203200', 'N8975': '50211600', 'N8915': '50620000', 'N6505': '51000000', 'N7220': '52101500', 'N7350': '52152100', 'N7230': '52131700', 'N7290': '52171000', 'N7310': '52151500', 'N7330': '52151600', 'N7340': '52151700', 'N5836': '52161563', 'N5965': '52161554', 'N8315': '53141600', 'N8400': '53112100', 'N8445': '53103200', 'N8460': '53121800', 'N8500': '53131800', 'N8520': '53131611', 'N8510': '53131620', 'N9910': '54111700', 'N6645': '54111710', 'N7600': '55111516', 'N7690': '55101522', 'N7640': '55101501', 'N7630': '55101519', 'N7610': '55111601', 'N7660': '55101514', 'N7650': '55101517', 'N9905': '55122003', 'N8455': '55121808', 'N7100': '56110000', 'N7105': '56101907', 'N7110': '56112304', 'N7195': '56131703', 'N7210': '56141806', 'N7820': '60141400', 'N8020': '60124500', 'N/A - S.O.': '95122700', 'N5410': '95141900', 'R012': '64141604', 'F020': '70161700', 'F030': '70101900', 'F008': '70111508', 'K107': '72102906', 'F021': '70123000', 'F004': '70131500', 'F005': '70131600', 'F006': '70142000', 'F010': '77101602', 'E103': '77141605', 'F04': '71161600', 'K199': '76111605', 'K100': '76111600', 'J': '85161500', 'W': '91101800', 'K106': '72102106', 'J000': '78181901', 'J019': '78182002', 'J058': '72151609', 'F05': '73151500', 'R1': '73151600', 'T014': '82121908', 'E108': '76131600', 'K112': '76111506', 'K111': '76111604', 'K104': '76121507', 'K114': '76122400', 'E111': '77131503', 'E199': '77141705', 'B101': '77101506', 'B208': '77101601', 'F059': '77101605', 'B329': '77101707', 'R010': '84111603', 'E110': '77111603', 'E101': '77121509', 'E106': '77131702', 'V401': '92101903', 'V402': '78141602', 'V200': '78142001', 'V002': '78101610', 'W000': '78141903', 'V100': '78142003', 'V001': '78142004', 'V3': '78111901', 'V403': '78102103', 'R103': '78102206', 'R106': '78102203', 'V202': '78111506', 'V203': '78111503', 'V006': '78111604', 'V102': '78111707', 'V005': '78111814', 'V010': '78111810', 'M290': '78141804', 'V009': '92101902', 'V504': '78141601', 'V507': '78130000', 'V505': '91111800', 'V508': '78141703', 'V506': '78131702', 'V5': '78181700', 'V501': '78141701', 'V500': '78141801', 'M120': '78141805', 'V204': '78141807', 'V4': '78142000', 'R199': '83120000', 'R120': '83101505', 'T004': '83121700', 'B302': '80101602', 'R115': '80101706', 'R201': '80111700', 'R003': '92101805', 'R118': '80131800', 'T001': '80171909', 'T003': '82101905', 'R105': '80141800', 'T002': '81112107', 'T018': '80161507', 'R117': '80161508', 'M190': '81141807', 'K115': '80161700', 'C219': '81102902', 'C129': '81101508', 'C216': '81102101', 'C112': '81101515', 'C122': '81101511', 'C119': '81101513', 'C124': '81101516', 'C211': '81101519', 'C130': '81101533', 'D302': '83112200', 'D308': '81111613', 'D307': '81111710', 'D301': '81162310', 'D317': '81161601', 'D315': '81112005', 'D399': '81161712', 'D311': '81112010', 'B506': '81121607', 'B303': '81131505', 'H1': '81141506', 'R114': '81141606', 'H9': '81141704', 'AZ': '85131700', 'B009': '81171702', 'T006': '81151605', 'T011': '81151603', 'T019': '81151604', 'B200': '81151705', 'B005': '81151806', 'B201': '81151904', 'W058': '81161801', 'F02': '81171501', 'B004': '81171801', 'B100': '81171901', 'T099': '82121802', 'R006': '82111503', 'R109': '82112067', 'T015': '82121702', 'T008': '82131600', 'T012': '82131601', 'T009': '82161500', 'T013': '82131604', 'T005': '82151700', 'G103': '82151600', 'S099': '83100000', 'S003': '83101510', 'S000': '83101605', 'S001': '83101903', 'S002': '83112600', 'D309': '83111900', 'R107': '83121500', 'L099': '84141503', 'R009': '84111802', 'L006': '84122001', 'L004': '84131905', 'L005': '84141702', 'G009': '85450000', 'G001': '85122200', 'G100': '85171700', 'G003': '85750000', 'U006': '86101811', 'U099': '86141700', 'U003': '86131800', 'U008': '86132205', 'V502': '90111900', 'V503': '90121800', 'G102': '90152100', 'T017': '90131600', 'K0': '91111902', 'K108': '91111500', 'G199': '91111904', 'AD': '92111700', 'K105': '92121901', 'K101': '92101604', 'K109': '92121701'}
				 
# converts requirement table into html using module Pandas
wb = pd.read_excel('requirement.xlsx')
wb.to_html('requirement.html', index=False)

# Replaces the \n with a New Line 
change_text = ("<br>") 			# asks user input
s = open("requirement.html").read()	# opens the file
s = s.replace(r'\n', change_text)	# replaces user input with matched text
f = open("requirement.html", 'w')	# writes changes to the file
f.write(s)				# Closes the file
f.close()

# Replaces the NaN with a space 
change_text = (" ") 			# asks user input
s = open("requirement.html").read()	# opens the file
s = s.replace("NaN", change_text)	# replaces user input with matched text
f = open("requirement.html", 'w')	# writes changes to the file
f.write(s)				# Closes the file
f.close()

en_GSIN = open('requirement.html', 'r')			# opens html file to read
en_UNSPSC = open('requirement_UNSPSC.html', 'w')	# opens html file to write
for line1 in en_GSIN:					# reads through html file and looks for dictionary key and replaces it in the write file
	for key1,value1 in d.items():
		line1 = line1.replace(key1, str(value1))
	en_UNSPSC.write(line1)
en_GSIN.close()						# closes html read file
en_UNSPSC.close()					# closes html write file
